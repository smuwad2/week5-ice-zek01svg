<!DOCTYPE html>
<html>
    <head>

        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        
         <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <div class="bg-light text-center p-5 mb-4">
            <h2>Choose an option:</h2>
            <label for="limit">Limit:</label>
            <input id="limit" type="number" min=1 max=5 value=1>
            <select onchange="getData()" id="type">
                <option value="customers">Customers</option>
                <option value="products">Products</option>
                <option value="suppliers">Suppliers</option>
            </select>
            
        </div>
        <div id="result">

        </div>
        <script>
            function getData() {
                var limit = document.getElementById('limit').value
                var type = document.getElementById('type').value
                const url = 'https://stunning-zebra-v6qvr9vgvpwvcwg7v-3000.app.github.dev/data'
                var data;

                axios.get(url, {
                    params: {
                        'type': type,
                        'limit': limit
                    }
                })
                .then(response => {
                    
                    data = response.data
                    dataType = data.type
                    dataRecords = data.records // this will be an array of objects

                    // crate null variables first
                    var h1 = document.createElement('h1')
                    var table = document.createElement('table')
                    table.className = 'table table-bordered'
                    var th;
                    var td;
                    var i;

                    // STEP 1: CREATE THE H1 ELEMENT ON TOP OF THE TABLE
                    var node = document.createTextNode(data.type)
                    h1.appendChild(node)
                    var result = document.getElementById('result')
                    result.appendChild(h1)

                    // STEP 2: CREATE THE TABLE HEADERS
                    tableHeaderRow = document.createElement('tr')
                    let tableHeaderContents = Object.keys(dataRecords[0]) // this is an array of appropriate headers

                    for (let thContent of tableHeaderContents) {
                        
                        th = document.createElement('th')
                        node = document.createTextNode(thContent)
                        th.appendChild(node)
                        tableHeaderRow.appendChild(th)
                        
                    }
                    table.appendChild(tableHeaderRow)
                    // result.appendChild(table)

                    // STEP 3: CREATE THE REST OF THE TABLE
                    // console.log(data)
                    // console.log(dataRecords)
                    for (dataRecord of dataRecords) {
                        tdRow = document.createElement('tr')

                        for (i=0;i<tableHeaderContents.length;i++) {
                            
                            var content = dataRecord[tableHeaderContents[i]]
                            console.log(content)
                            td = document.createElement('td')
                            node = document.createTextNode(content)
                            td.appendChild(node)
                            tdRow.appendChild(td)

                        }
                        table.appendChild(tdRow)
                        result.appendChild(table)

                    }
                    

                    
                    
                    
                })




            }

        </script>
</body>
</html>